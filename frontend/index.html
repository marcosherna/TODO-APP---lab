<!DOCTYPE html>
<html lang="en" x-data="{ isDark: false }" x-bind:class="{ 'dark': isDark }">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="./output.css" rel="stylesheet" />

  <!-- #region development -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>  -->
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- #endregion -->

  <!-- Alpine Plugins -->
  <script src="./api.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/anchor@3.x.x/dist/cdn.min.js"></script>

  <!-- alpine-js -->
  <!-- alpine-js -->
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <!-- <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script> -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>  -->


  <!-- <script src="https://unpkg.com/lucide@latest"></script> -->

  <script>
    tailwind.config = {
      darkMode: "class",
    };

    function formatDate(dateString) {
      const date = new Date(dateString)
      const formatted = date.toLocaleDateString("en-US", {
        weekday: "long",
        day: "2-digit",
        month: "short",
        year: "numeric"
      });
      return formatted
    }


    document.addEventListener("alpine:init", () => {
      Alpine.data("mainTask", () => ({
        showFormDrawer: false,

        id: 0,
        title: "",
        description: "",
        completed: false,
        postFormLoading: false,
        isUpdating: false,

        handleCloseFormDrawer() {
          this.id = 0;
          this.title = "";
          this.description = "";
          this.completed = false;
          this.isUpdating = false;
          this.showFormDrawer = false;
        },

        handleOpenFormDrawer() {
          this.showFormDrawer = true;
        },

        loading: false,
        isEmpty: true,
        tasks: [],
        async getAllTask() {
          try {
            this.loading = true;

            const taskData = await getTasks();

            this.tasks = taskData;

            this.isEmpty = this.tasks.length === 0;
          } catch (error) {
          } finally {
            this.loading = false;
            lucide.createIcons();
          }
        },

        async postSubmit() {
          try {
            this.postFormLoading = true;

            if (this.isUpdating && this.id !== 0) {
              const indexTask = this.tasks.findIndex((t) => t.id === this.id);
              const task = await updateTask(this.id, {
                title: this.title,
                description: this.description,
              });

              this.tasks[indexTask] = task;
              // await this.getAllTask() 
            } else {
              const task = await createTask({
                title: this.title,
                description: this.description,
              });

              this.tasks.push(task);
              if (this.tasks.length > 0) {
                this.isEmpty = false
              }
            }
            this.postFormLoading = false;
            this.handleCloseFormDrawer();

            await this.$nextTick();
            lucide.createIcons();

            // await this.getAllTask();
          } catch (error) {
            console.log(error);
          } finally {
            this.postFormLoading = false;
          }
        },

        handleSelectTask(task) {
          this.isUpdating = true;
          this.id = task.id;
          this.title = task.title;
          this.description = task.description;
          this.completed = task.completed;

          this.handleOpenFormDrawer();
        },

        async handleDeleteTask(taskId) {
          try {
            const tasks = this.tasks.filter(t => t.id !== taskId)
            await deleteTask(taskId)
            this.tasks = [...tasks]
            if (this.tasks.length === 0) {
              this.isEmpty = true
            }
          } catch (error) {
            console.log(error)
          } finally {
          }
        },


        async handleToggleStatu(taskData) {
          let result = taskData.completed
          try {
            const task = await updateTask(taskData.id, {
              completed: !taskData.completed,
            });
            result = !taskData.completed
          } catch (error) {
            console.log(error)
          }
          return result
        }

      }));
    });
  </script>

  <style>
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    *::-webkit-scrollbar {
      width: 8px;
    }

    *::-webkit-scrollbar-track {
      background: rgba(203, 213, 225, 0.3);
      border-radius: 9999px;
    }

    *::-webkit-scrollbar-thumb {
      background-color: rgba(59, 130, 246, 0.5);
      border-radius: 9999px;
      border: 2px solid transparent;
      background-clip: content-box;
    }

    .dark *::-webkit-scrollbar-track {
      background: rgba(55, 65, 81, 0.3);
    }

    .dark *::-webkit-scrollbar-thumb {
      background-color: rgba(96, 165, 250, 0.5);
    }
  </style>

  <title>TODO APP</title>
</head>

<body
  class="flex flex-col-reverse w-full md:h-screen overflow-y-auto space-y-3 md:flex-row md:overflow-y-hidden md:space-y-0 md:space-x-3 bg-gray-200 dark:bg-gray-900">
  <main x-data="scrollNav()" class="flex w-full h-screen overflow-hidden bg-gray-200 dark:bg-gray-900">
    <!-- Barra lateral -->
    <ul
      class="flex flex-col justify-center items-center relative bg-gray-200/60 dark:bg-gray-800/60 backdrop-blur-md shadow-inner w-[60px] space-y-3 rounded-2xl">
      <template x-for="(item, index) in navItems" :key="index">
        <li
          class="flex items-center justify-center h-[60px] w-[60px] cursor-pointer relative transition-all duration-300 ease-in-out hover:text-blue-600 dark:hover:text-blue-400 hover:bg-white/40 dark:hover:bg-white/10 hover:backdrop-blur-lg hover:shadow-[0_0_10px_rgba(59,130,246,0.3)] rounded-xl"
          :class="active === item.id 
        ? 'text-white font-bold bg-blue-600/70 dark:bg-blue-500/40 backdrop-blur-md shadow-[0_0_10px_rgba(59,130,246,0.5)] rounded-xl' 
        : 'text-gray-800 dark:text-gray-200'" x-on:click="scrollTo(item.id)">
          <i :data-lucide="item.icon" class="w-6 h-6"></i>
        </li>
      </template>
    </ul>

    <!-- Contenido desplazable -->
    <div class="flex-1 overflow-y-auto scroll-smooth no-scrollbar" x-ref="container"
      @scroll.debounce.100="checkActive()">
      <section id="home" class="h-screen flex flex-col items-center justify-center px-6 transition-colors duration-300">
        <div class="flex flex-col items-center gap-5 backdrop-blur-md p-8 transition-all duration-300">
          <div class="flex items-center gap-3 w-full mb-2">
            <i data-lucide="notebook-pen" class="w-10 h-10 text-blue-600 dark:text-blue-400 animate-pulse"></i>
            <h1 class="text-4xl font-extrabold text-gray-800 dark:text-gray-100 tracking-tight">
              Todo App
            </h1>
          </div>

          <!-- Descripci√≥n -->
          <p class="text-gray-700 dark:text-gray-300 text-base leading-relaxed">
            <span class="font-semibold">Todo App</span> es una aplicaci√≥n web
            desarrollada como parte del proyecto acad√©mico de la asignatura
            <span class="italic text-blue-600 dark:text-blue-400">Implantaci√≥n de Sistemas</span>
            de la
            <span class="font-semibold">Universidad de Sonsonate</span>.
          </p>

          <p class="text-gray-700 dark:text-gray-300 text-base leading-relaxed">
            El objetivo principal es poner en pr√°ctica conceptos de desarrollo
            de software, dise√±o de interfaces y manipulaci√≥n de datos mediante
            tecnolog√≠as modernas
          </p>

          <!-- Funcionalidades -->
          <div class="w-full text-left">
            <h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2 mb-4">
              Funcionalidades principales
            </h2>
            <ul class="space-y-2 pl-6">
              <li class="flex items-center gap-3 text-gray-700 dark:text-gray-300">
                <i data-lucide="plus-circle" class="w-5 h-5 text-green-500"></i> Crear nuevas tareas
              </li>
              <li class="flex items-center gap-3 text-gray-700 dark:text-gray-300">
                <i data-lucide="edit-3" class="w-5 h-5 text-yellow-500"></i> Editar tareas existentes
              </li>
              <li class="flex items-center gap-3 text-gray-700 dark:text-gray-300">
                <i data-lucide="trash-2" class="w-5 h-5 text-red-500"></i> Eliminar tareas completadas
              </li>
              <li class="flex items-center gap-3 text-gray-700 dark:text-gray-300">
                <i data-lucide="list-checks" class="w-5 h-5 text-indigo-500"></i> Listar todas las tareas guardadas
              </li>
              <li class="flex items-center gap-3 text-gray-700 dark:text-gray-300">
                <i data-lucide="moon-star" class="w-5 h-5 text-purple-500"></i> Cambiar entre modo claro y oscuro
              </li>
            </ul>
          </div>
          <!-- Estado visual del tema -->
          <div class="flex gap-2 w-full items-center mt-2">
            <span x-text="isDark ? 'üåô Modo oscuro activado' : '‚òÄÔ∏è Modo claro activado'"
              class="text-sm text-gray-600 dark:text-gray-400 transition-colors duration-300"></span>

            <button x-on:click="isDark = !isDark"
              class="bg-blue-200 hover:bg-blue-300 active:bg-blue-200 focus:outline-none focus:ring-1 focus:ring-blue-400 text-blue-700 dark:text-blue-200 dark:bg-blue-900 dark:hover:bg-blue-800 px-3 py-1 rounded-lg text-sm items-center flex gap-1 transition-colors">
              cambiar
            </button>
          </div>
      </section>

      <section id="dev" class="h-screen flex flex-col items-center justify-center px-6 transition-colors duration-300">
        <div class="flex flex-col items-center gap-5 backdrop-blur-md  p-8 transition-all duration-300">
          <!-- Logo o √≠cono -->
          <div class="flex items-center gap-3 w-full mb-2">
            <i data-lucide="cpu" class="w-10 h-10 text-blue-600 dark:text-blue-400 animate-pulse"></i>
            <h1 class="text-4xl font-extrabold text-gray-800 dark:text-gray-100 tracking-tight">
              Development
            </h1>
          </div>

          <!-- Descripci√≥n general -->
          <p class="text-gray-700 dark:text-gray-300 text-base leading-relaxed">
            Esta aplicaci√≥n web destaca por su <span class="font-semibold">alta reactividad</span> e <span
              class="font-semibold">interactividad</span>.
            Cada acci√≥n del usuario se refleja de forma inmediata en la interfaz, proporcionando una experiencia fluida
            y din√°mica.
          </p>

          <!-- Tecnolog√≠as utilizadas -->
          <div class="w-full text-left">
            <h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2 mb-4">
              Tecnolog√≠as empleadas
            </h2>
            <ul class="space-y-2 pl-6 text-gray-700 dark:text-gray-300">
              <li class="flex items-center gap-3">
                <i data-lucide="code-xml" class="w-5 h-5 text-orange-500"></i>
                HTML5 para la estructura de la aplicaci√≥n
              </li>
              <li class="flex items-center gap-3">
                <i data-lucide="code" class="w-5 h-5 text-green-500"></i>
                TailwindCSS para estilos modernos y responsive
              </li>
              <li class="flex items-center gap-3">
                <i data-lucide="zap" class="w-5 h-5 text-purple-500"></i>
                Alpine.js para interactividad y manejo de estados reactivos
              </li>
              <li class="flex items-center gap-3">
                <i data-lucide="code" class="w-5 h-5 text-yellow-500"></i>
                JavaScript para l√≥gica y manipulaci√≥n del DOM
              </li>
            </ul>
          </div>

          <!-- Ejemplo de interactividad -->
          <div class="w-full mt-5 text-left">
            <h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2 mb-2">
              <i data-lucide="cpu" class="w-5 h-5 text-blue-500 dark:text-blue-400"></i>
              Interactividad en acci√≥n
            </h2>
            <p class="text-gray-700 dark:text-gray-300 mb-2">
              Puedes probar la interactividad cambiando el tema de la aplicaci√≥n con el bot√≥n abajo:
            </p>
            <button x-on:click="isDark = !isDark"
              class="bg-blue-200 hover:bg-blue-300 active:bg-blue-200 focus:outline-none focus:ring-1 focus:ring-blue-400 text-blue-700 dark:text-blue-200 dark:bg-blue-900 dark:hover:bg-blue-800 px-3 py-1 rounded-lg text-sm flex gap-1 items-center transition-colors">
              Cambiar tema
            </button>
          </div>
        </div>
      </section>


      <section id="about"
        class="h-screen flex flex-col items-center justify-center px-6 transition-colors duration-300">
        <div class="flex flex-col items-center gap-5 backdrop-blur-md  p-8 transition-all duration-300">
          <!-- Logo o √≠cono -->
          <div class="flex items-center gap-3 w-full mb-2">
            <i data-lucide="user" class="w-10 h-10 text-blue-600 dark:text-blue-400 animate-pulse"></i>
            <h1 class="text-4xl font-extrabold text-gray-800 dark:text-gray-100 tracking-tight">
              About
            </h1>
          </div>

          <p class="text-gray-700 dark:text-gray-300 text-base leading-relaxed">
            Esta aplicaci√≥n, <span class="font-semibold">Todo App</span>, es parte de una tarea de la asignatura
            <span class="italic text-blue-600 dark:text-blue-400">Implantaci√≥n de Sistemas</span>
            de la <span class="font-semibold">Universidad de Sonsonate</span>. S√≠, otra tarea m√°s,
            pero al menos esta tiene estilo.
          </p>

          <!-- Sobre el desarrollador -->
          <div class="w-full text-left mt-4">
            <h2 class="text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2 mb-2">
              <i data-lucide="user-check" class="w-5 h-5 text-green-500"></i>
              Sobre el desarrollador
            </h2>
            <p class="text-gray-700 dark:text-gray-300 leading-relaxed">
              Hola, soy <span class="font-semibold">Marcos Enrique Ramos Hernandez</span>, estudiante y programador
              ocasionalmente heroico. Este proyecto fue mi excusa perfecta para practicar
              <span class="font-semibold">HTML, TailwindCSS, Alpine.js</span> y mis habilidades de
              manipulaci√≥n del DOM (s√≠, todav√≠a me sorprende que funcione a la primera).

              <span class="font-semibold">...Espero xd</span>
            </p>
            <p class="text-gray-700 dark:text-gray-300 leading-relaxed mt-2">
              Por supuesto, no lo hice solo: tuve la inestimable ayuda de <span
                class="font-semibold text-purple-500">ChatGPT</span>,
              que b√°sicamente me salv√≥ de escribir miles de l√≠neas de c√≥digo aburrido. Gracias, asistente ü§ñ.
            </p>
          </div>

          <!-- Cr√©ditos -->
          <div
            class="text-center mt-6 border-t border-gray-300/50 dark:border-gray-700/50 pt-4 text-sm text-gray-600 dark:text-gray-400 space-y-2">
            <p class="flex items-center justify-center gap-2">
              <i data-lucide="book-open" class="w-4 h-4 text-blue-500 dark:text-blue-400"></i>
              Universidad de Sonsonate ‚Äî Facultad de Ingenier√≠a y Ciencias Naturales
            </p>

            <p class="flex items-center justify-center gap-2">
              <i data-lucide="cpu" class="w-4 h-4 text-purple-500 dark:text-purple-400"></i>
              Con la colaboraci√≥n de ChatGPT (s√≠, me ayud√≥ y no me averg√ºenzo üòé)
            </p>
            <p class="flex items-center justify-center gap-2">
              <i data-lucide="calendar" class="w-4 h-4 text-green-500 dark:text-green-400"></i>
              A√±o: 2025
            </p>
          </div>
        </div>
      </section>

    </div>
  </main>

  <aside class="flex justify-center items-center h-screen p-4 md:pr-10">
    <div x-data="mainTask"
      class="relative w-full md:w-[325px] h-full max-h-[760px] md:rounded-2xl shadow-lg bg-white dark:bg-gray-800 overflow-hidden border border-gray-300/20 dark:border-gray-700/20 backdrop-blur-sm transition-colors duration-300">
      <!-- header -->
      <div class="flex items-end justify-between px-5 mt-5 mb-2">
        <span>
          <h2 class="font-medium text-xl text-gray-800 dark:text-gray-200">
            Mis Tareas
          </h2>
          <span x-data="{ date: new Date().toString() }" x-text="formatDate(date)"
            class="text-sm text-gray-500 dark:text-gray-400">Wednesday, 11 may</span>
        </span>
        <button x-on:click="handleOpenFormDrawer()"
          class="bg-blue-200 hover:bg-blue-300 active:bg-blue-200 focus:outline-none focus:ring-1 focus:ring-blue-400 text-blue-700 dark:text-blue-200 dark:bg-blue-900 dark:hover:bg-blue-800 px-3 py-1 rounded-lg text-sm items-center flex gap-1 transition-colors">
          <span>+</span>
          <span>Nuevo</span>
        </button>
      </div>

      <!-- loading template -->
      <template x-if="loading">
        <span class="flex flex-col justify-center items-center text-blue-500 dark:text-blue-400 mt-7">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"
            aria-hidden="true">
            <rect x="1" y="6" width="2.8" height="12">
              <animate id="spinner_a" begin="0;spinner_e.end-0.1s" attributeName="y" dur="0.6s" values="6;1;6"
                calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
              <animate begin="0;spinner_e.end-0.1s" attributeName="height" dur="0.6s" values="12;22;12"
                calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
            </rect>
            <rect x="5.8" y="6" width="2.8" height="12">
              <animate begin="spinner_a.begin+0.1s" attributeName="y" dur="0.6s" values="6;1;6" calcMode="spline"
                keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
              <animate begin="spinner_a.begin+0.1s" attributeName="height" dur="0.6s" values="12;22;12"
                calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
            </rect>
            <rect x="10.6" y="6" width="2.8" height="12">
              <animate begin="spinner_a.begin+0.2s" attributeName="y" dur="0.6s" values="6;1;6" calcMode="spline"
                keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
              <animate begin="spinner_a.begin+0.2s" attributeName="height" dur="0.6s" values="12;22;12"
                calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
            </rect>
            <rect x="15.4" y="6" width="2.8" height="12">
              <animate begin="spinner_a.begin+0.3s" attributeName="y" dur="0.6s" values="6;1;6" calcMode="spline"
                keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
              <animate begin="spinner_a.begin+0.3s" attributeName="height" dur="0.6s" values="12;22;12"
                calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
            </rect>
            <rect x="20.2" y="6" width="2.8" height="12">
              <animate id="spinner_e" begin="spinner_a.begin+0.4s" attributeName="y" dur="0.6s" values="6;1;6"
                calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
              <animate begin="spinner_a.begin+0.4s" attributeName="height" dur="0.6s" values="12;22;12"
                calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
            </rect>
          </svg>

          <span class="text-sm">Cargando...</span>
        </span>
      </template>

      <!-- empty state template -->
      <template x-if="!loading && isEmpty">
        <div class="flex flex-col w-full max-w-sm px-4 mx-auto mt-7">
          <!-- √≠cono -->
          <div class="p-3 mx-auto text-blue-500 bg-blue-100 dark:bg-blue-700 dark:text-blue-200 rounded-full">
            <i data-lucide="clipboard" class="w-6 h-6"></i>
          </div>

          <!-- t√≠tulo -->
          <h1 class="text-center text-lg text-gray-700 dark:text-gray-200 mt-4">
            No tienes tareas
          </h1>

          <!-- descripci√≥n -->
          <p class="text-center mt-2 text-gray-500 dark:text-gray-400">
            Intenta nuevamente o crea una nueva tarea.
          </p>
        </div>
      </template>

      <!-- list -->
      <div x-data="{
          async init(){
            await getAllTask();
            await this.$nextTick();
            lucide.createIcons();
          }
        }" x-init="init()" class="h-full p-5 pr-2 overflow-auto">
        <template x-if="!loading && !isEmpty">
          <template x-for="(task, index) in tasks" :key="task.id">
            <!-- #region task card -->
            <!-- collapse -->
            <div x-data="{ expanded: false, completed: task.completed }" class="w-full mb-2"
              x-bind:class="index === (tasks.length -1) ? `mb-7`: ``">
              <!-- Encabezado -->
              <div
                class="flex flex-row items-center w-full bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-300 rounded-md shadow-sm transition-all duration-300">
                <!-- Bot√≥n expandir -->
                <button x-on:click="expanded = !expanded"
                  class="flex flex-nowrap items-center gap-2 w-full pl-3 font-medium text-sm tracking-wide hover:bg-gray-300/50 dark:hover:bg-gray-600/50 rounded-md transition-colors duration-300 py-2">
                  <span><i data-lucide="chevron-right" class="transition-transform duration-300"
                      :class="expanded ? 'rotate-90' : 'rotate-0'"></i></span>
                  <h4 x-text="task.title" class="line-clamp-1">
                    Tarea pendiente
                  </h4>
                </button>

                <!-- Dropdown eliminar -->
                <div x-show="!expanded" x-data="{ open: false }" class="flex items-center">
                  <button x-ref="button" x-on:click="open = !open"
                    class="py-2 pl-2 pr-4 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-md transition-colors duration-300">
                    <i data-lucide="trash-2" class="h-[18px] w-[18px]"></i>
                  </button>

                  <!-- Confirmaci√≥n -->
                  <div x-show="open" x-anchor.left-start="$refs.button" x-anchor.offset.10="$refs.button" x-transition
                    class="flex flex-col space-y-2 shadow-lg bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 p-3 rounded-md border border-gray-200 dark:border-gray-600">
                    <h4 class="text-sm font-semibold">¬øEst√° seguro?</h4>
                    <div class="flex gap-2 text-sm">
                      <button x-on:click="open = false"
                        class="px-3 py-1 rounded-md bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 transition">
                        Cancelar
                      </button>
                      <!-- button-delete -->
                      <button x-data="{
                        async fnDelete(){
                          await handleDeleteTask(task.id) 
                          open = false
                        }
                      }" x-on:click="fnDelete()"
                        class="px-3 py-1 rounded-md bg-red-200 dark:bg-red-700 hover:bg-red-300 dark:hover:bg-red-600 active:bg-red-200 dark:active:bg-red-800 focus:outline-none focus:ring-1 focus:ring-red-400 text-red-700 dark:text-red-200 transition">
                        Eliminar
                      </button>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Contenido expandible -->
              <div x-show="expanded" x-transition
                class="flex flex-col p-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-sm">
                <p x-text="task.description" class="text-gray-700 dark:text-gray-200 text-sm leading-relaxed">
                  Lorem ipsum dolor sit
                </p>

                <!-- Info -->
                <div
                  class="flex items-start gap-2 p-2 mt-3 bg-white dark:bg-gray-700 rounded-md border border-gray-200 dark:border-gray-700">
                  <i data-lucide="info" class="text-blue-500 dark:text-blue-400 mt-[2px]"></i>
                  <div>
                    <span x-text="formatDate(task.created_at)"
                      class="text-xs text-gray-500 dark:text-gray-400 block">2025-10-13T10:00:00Z</span>
                    <div class="flex items-center space-x-2 mt-0.5 text-sm text-gray-700 dark:text-gray-200">
                      <span>Autor: <b>me</b></span>

                      <!-- tag -->
                      <span x-text="completed ? `Completado`: `Pendiente`" class="text-xs px-2 py-px rounded-lg"
                        x-bind:class="completed ? `border-blue-500 text-blue-600 bg-blue-100 dark:bg-blue-800 dark:text-blue-200` : `border-orange-500 text-orange-600 bg-orange-100 dark:bg-orange-800 dark:text-orange-200`">
                        Completado
                      </span>
                    </div>
                  </div>
                </div>
                <!-- Footer -->
                <div class="flex justify-between items-center px-2 pt-3">
                  <!-- Switch -->
                  <label x-data="{
                    async fnToggleStatus(){
                       await handleToggleStatu(task) 
                    }
                  }" class="relative inline-flex items-center cursor-pointer select-none">
                    <input x-on:change="fnToggleStatus()" x-model="completed" type="checkbox" class="sr-only peer" />
                    <div
                      class="w-10 h-5 bg-gray-300 dark:bg-gray-600 rounded-full peer-focus:ring-2 peer-focus:ring-blue-400 peer-checked:bg-blue-600 transition-colors duration-300 ease-in-out">
                    </div>
                    <div
                      class="absolute left-0.5 top-0.5 w-[16px] h-4 bg-white dark:bg-gray-200 border border-gray-300 dark:border-gray-500 rounded-full transition-transform duration-300 ease-in-out peer-checked:translate-x-5">
                    </div>
                  </label>

                  <!-- button-actions -->
                  <div class="flex gap-1 text-gray-600 dark:text-gray-300">
                    <button x-on:click="handleDeleteTask(task.id) "
                      class="hover:bg-red-300 dark:hover:bg-red-700 hover:text-red-600 dark:hover:text-red-200 rounded-md p-2 transition-colors duration-300">
                      <i data-lucide="trash-2" class="h-[18px] w-[18px]"></i>
                    </button>
                    <button x-on:click="handleSelectTask(task)"
                      class="hover:bg-blue-300 dark:hover:bg-blue-700 hover:text-blue-600 dark:hover:text-blue-200 rounded-md p-2 transition-colors duration-300">
                      <i data-lucide="pencil" class="h-[18px] w-[18px]"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
            <!-- #endregion -->
          </template>
        </template>

        <!-- overlay (invisible al inicio) -->
        <div x-show="showFormDrawer" x-transition.opacity x-on:click="handleCloseFormDrawer()"
          class="absolute inset-0 bg-black/30 transition-opacity duration-300"></div>
      </div>

      <div x-show="showFormDrawer" x-transition:enter="transition transform duration-300"
        x-transition:enter-start="translate-y-full" x-transition:enter-end="translate-y-0"
        x-transition:leave="transition transform duration-300" x-transition:leave-start="translate-y-0"
        x-transition:leave-end="translate-y-full"
        class="absolute bottom-0 bg-white dark:bg-gray-800 w-full px-5 pt-2 pb-4 rounded-t-md">
        <div class="flex justify-between items-center mb-3">
          <h3 class="text-lg font-medium text-gray-800 dark:text-gray-200">
            Nueva Tarea
          </h3>

          <!-- button-close-drawer -->
          <button x-on:click="handleCloseFormDrawer()"
            class="hover:bg-gray-300 dark:hover:bg-gray-600 active:bg-gray-200 dark:active:bg-gray-700 focus:outline-none focus:ring-1 focus:ring-gray-400 dark:focus:ring-gray-500 text-gray-700 dark:text-gray-200 p-2 rounded-lg text-sm items-center flex gap-1 transition-colors">
            <i data-lucide="x" class="h-[18px] w-[18px]"></i>
          </button>
        </div>

        <!-- form -->
        <form x-on:submit.prevent="postSubmit()" class="space-y-3">
          <input x-model="title" x-bind:disabled="postFormLoading" type="text" placeholder="Title..." required
            class="w-full border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-400" />
          <textarea x-model="description" x-bind:disabled="postFormLoading" placeholder="Description..." rows="3"
            class="w-full border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 text-sm text-gray-800 dark:text-gray-200 bg-white dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-400"></textarea>

          <div class="flex w-full items-center justify-between">
            <!-- toggle -->
            <!-- <label x-show="isUpdating" class="relative inline-flex items-center cursor-pointer select-none">
              <input x-model="completed" x-bind:disabled="postFormLoading" type="checkbox" class="sr-only peer" />
              <div
                class="w-10 h-5 bg-gray-300 dark:bg-gray-600 rounded-full peer-focus:ring-2 peer-focus:ring-blue-400 peer-checked:bg-blue-600 transition-colors duration-300 ease-in-out">
              </div>
              <div
                class="absolute left-0.5 top-0.5 w-[16px] h-4 bg-white dark:bg-gray-200 border border-gray-300 dark:border-gray-500 rounded-full transition-transform duration-300 ease-in-out peer-checked:translate-x-5">
              </div>
            </label> -->

            <!-- button-save -->
            <button x-bind:disabled="postFormLoading" type="submit"
              class="bg-blue-200 dark:bg-blue-900 hover:bg-blue-300 dark:hover:bg-blue-800 active:bg-blue-200 dark:active:bg-blue-700 focus:outline-none focus:ring-1 focus:ring-blue-400 text-blue-700 dark:text-blue-200 flex flex-row px-3 py-1 rounded-lg text-sm items-center gap-1 transition-colors">
              <template x-if="postFormLoading">
                <span class="text-blue-700">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="15" height="15" fill="currentColor"
                    aria-hidden="true">
                    <rect x="1" y="6" width="2.8" height="12">
                      <animate id="spinner_a" begin="0;spinner_e.end-0.1s" attributeName="y" dur="0.6s" values="6;1;6"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                      <animate begin="0;spinner_e.end-0.1s" attributeName="height" dur="0.6s" values="12;22;12"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                    </rect>
                    <rect x="5.8" y="6" width="2.8" height="12">
                      <animate begin="spinner_a.begin+0.1s" attributeName="y" dur="0.6s" values="6;1;6"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                      <animate begin="spinner_a.begin+0.1s" attributeName="height" dur="0.6s" values="12;22;12"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                    </rect>
                    <rect x="10.6" y="6" width="2.8" height="12">
                      <animate begin="spinner_a.begin+0.2s" attributeName="y" dur="0.6s" values="6;1;6"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                      <animate begin="spinner_a.begin+0.2s" attributeName="height" dur="0.6s" values="12;22;12"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                    </rect>
                    <rect x="15.4" y="6" width="2.8" height="12">
                      <animate begin="spinner_a.begin+0.3s" attributeName="y" dur="0.6s" values="6;1;6"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                      <animate begin="spinner_a.begin+0.3s" attributeName="height" dur="0.6s" values="12;22;12"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                    </rect>
                    <rect x="20.2" y="6" width="2.8" height="12">
                      <animate id="spinner_e" begin="spinner_a.begin+0.4s" attributeName="y" dur="0.6s" values="6;1;6"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                      <animate begin="spinner_a.begin+0.4s" attributeName="height" dur="0.6s" values="12;22;12"
                        calcMode="spline" keySplines=".36,.61,.3,.98;.36,.61,.3,.98" />
                    </rect>
                  </svg>
                </span>
              </template>
              <span x-text="postFormLoading ? `Cargando...` : `Guardar`"></span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </aside>

  <!-- scripts  -->
  <script>
    lucide.createIcons();
    function scrollNav() {
      return {
        active: "home",
        navItems: [
          { id: 'home', icon: 'home' },
          { id: 'dev', icon: 'code' },
          { id: 'about', icon: 'info' },
        ],
        async scrollTo(id) {
          document.getElementById(id).scrollIntoView({ behavior: "smooth" });
          this.active = id;
        },
        async checkActive() {
          const container = this.$refs.container;
          const scrollPos = container.scrollTop + container.clientHeight / 2;
          this.navItems.forEach((item) => {
            const section = document.getElementById(item.id);
            const top = section.offsetTop;
            const bottom = top + section.offsetHeight;
            if (scrollPos >= top && scrollPos < bottom) {
              this.active = item.id;
            }
          });

        },
      };
    }
  </script>
  <!-- #endregion -->
</body>

</html>